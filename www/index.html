<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
         <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />        
        <title>Hello</title>
    </head>
    <body>
         <div id="map"></div>        
         <div id="overhead">
	        <div class="fotorama">
		    	<button id="jump">Прыгнуть в Б. А. У. и самовыпилиться</button>
			</div> 
         </div>
    </body>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> 
		
		<link  href="http://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.3/fotorama.css" rel="stylesheet">
		<script src="http://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.3/fotorama.js"></script>

        <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet-src.js"></script>
        <script>
            var map = L.map('map');
            
            var LocationIcon = L.Icon.extend({
			    options: {
			        iconUrl: 'img/location.png?v=2',
			        iconSize:     [40, 40],
			        iconAnchor:   [18, 14],
			        shadowAnchor: [4, 62],
			        popupAnchor:  [-3, -76]
			    }
			});
            
            var Arrow = new LocationIcon;
            
            L.tileLayer("http://tiles.{s}.st.vmp.ru/{z}/{x}/{y}.png", {
                minZoom: 10,
                maxZoom: 18,
                detectRetina: true,
                attributionControl: false,
                zoomControl: false,
            }).addTo(map)   
            

	        map.locate({setView: true, maxZoom: 16});         	            

            

            
            function onLocationFound(e) {
	            
	            console.log('loc found', e.latlng.lat, e.latlng.lng);
			    var radius = e.accuracy / 2;
			
			    L.marker(e.latlng, {icon: Arrow}).addTo(map);
			
			    L.circle(e.latlng, radius, {border: 0}).addTo(map);
			    
// 				alert(e.latlng);
			    
				$('#jump').click(function () {

					map.setView(e.latlng);
				});
			}
			
			map.on('locationfound', onLocationFound);
        </script>   
</html>